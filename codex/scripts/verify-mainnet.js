const hre = require("hardhat");
const fs = require("fs");

async function main() {
  console.log("üîç Starting contract verification on Ethereum Mainnet...");

  // Read deployment info
  let deploymentInfo;
  try {
    const data = fs.readFileSync("deployment-mainnet.json", "utf8");
    deploymentInfo = JSON.parse(data);
  } catch (error) {
    console.error("‚ùå Could not read deployment-mainnet.json. Please run deployment first.");
    process.exit(1);
  }

  const { contracts } = deploymentInfo;
  
  // ASCII Art for verification
  const specialCodeLight = "+-+++-.--------+++++--.---+----+++++--------++++++++-.-------+++---.-#########-...----++++++-.---+++\n+-+++-.------.---+++--.----------++--.-.+----------+-.---------++--..#########-.-##------+++-.----+-\n+-----..----.+##+..........-----------####-----------.---------##+...+########-....-###-----...-----\n+--+++-------+####+----------.-----.+#####+.-----------------.-----+##########-++..-+---------------\n#--++++++++--+###++#+.-------.----+###++###.--------++++++++-.-++--#########--.------.--------++++++\n#------+++++-+###+++##+-----++++-##-#######--------------------+++-..#########---+---.-++++-----++++\n+------------+####+-##############++#######------------------+++-.-##############+++-.-----------+++\n+............-####+############+###+-++#+##--....-.....-##-++..-############+..............---------\n+++++-.-------##############################-..-.##+++#######--+#####++####--++++-++--+------.---+--\n+++++-.-------+###############+#############----+##################+++#+--.+##+-----++++++++-.-+++++\n+--++-.-------##################################++############+######+####+#####+--+###+++++---+++++\n+--++-.-----.##############################################################--++++++++---++---.--++++\n+----....-..-###+-#.+#########-#--+##############################+#########++++#+----..-----...-----\n+--++++++----###+-#+-########-+##+-##############################################--+++--------------\n+---++++++---#####+++########+---+#############################################++--###+-------++++++\n+---+--+++----#####################################+#########################+.+##---.---------+++++\n+------++++++++++####+---+#####################################################+--+##.----------+++-\n+---......---++++######+#############################################+######+####-....--..........--\n+++++-.-++----+#++#####++############+##########################################--.###++--++-.--++++\n#++++------+#+-++--.-##############################################################+++..-----.-+++++\n+-+++-.--++---++-----..-+########################################+####################--+----.--++++\n+--+-----------------..-+################################+############################+.-+---.---+++\n+..-...................-###############+###############++##############################--.......----\n++++++++++++--.----------#############+################+########################++####++------++++++\n+-+++++++++++-.---------.-###########++###############+#######################-.-######-##+-++++++++\n+-----+++++++-.----------.-##########--##############################++###+------+#####-.+#+--++++-+\n+---------+---.-------------#########-+++###############+#############------------#####+-.------+++-\n+----........................+#####++++##############+-....-+#########+++-........#######++-......--\n+++++-.-------+++++++---------..+++###############+.----------...+######.----.-----######+--.-++++++\n+++++----------++++++-.-----.--###################...---++++++++--######++++------.#########-.--++++\n+-+++-.----------++++-.--.-#######################+-------++++++--+#####+------+++--+#####+-.----+++\n+----------------------+#######################+-..----------++----#######--------+---..-----.------\n+------------..---..-###################+++####-...------......-...+#######--.................------\n+--+++++++++--.---+#################---++####+-.-----+++++++-.-----.-#####-.-+++++++-.-++++++++++++-\n#---+++++++++-.-###############-...-########+---------++++++-.-------......--+++++++-.----+++++++++-\n#------+++--+##############+------+#########+.----------++++------------------++++++-.------+++++++-\n+----------######+#######---------#######++--.----------------------------------++++-.----+-----+++-\n+---......+#+##++######--.......-########+++--..-..............................................-----\n+++++-.---.-+##+####+.--+-------#######+--++++++++++-.         BUGCAT CODEX: COMPLETE        .-+++++\n+-+++-.--------..-----.-----+-+#######-.---+++++++++-. [reentrancy] [predictable] [overflow] .--++++\n+--++------------++++-.------+#######+---------+++++-.      [unprotected] [misspelled]       .---+++\n+-----.---------------.----+########+.---------------.          All wounds witnessed.        .------\n+------------..-------.+###########-..........................................--.............-------\n++-++++++++++-.---+--.############-.--++++++-.---+++++++++++-.-----+++++++++---+++++++++++++++++++++\n#+--+++++++++-.------.##########-.---+++++++-.-------+++++++-.-------+++++++---+++++----++++++++++++\n#+--+++++++++-.----++----++-------+++--------.---------++++--.----------++++---++++-------++++++++++";

  const specialCodeDark = "-+---+#++++++++-----++#+++-++++-----++++++++--------+#+++++++---+++#+. .......+###++++------+#+++---\n-+---+#++++++#+++---++#++++++++++--++#+#-++++++++++-+#+++++++++--++##. .   .  +#+..++++++---+#++++++\n-+++++##++++#-..-##########+++++++++++.. .+++++++++++#+++++++++..-###-   ..   +####+...+++++###+++++\n-++---+++++++- ...-++++++++++#+++++#-.... -#+++++++++++++++++#+++++-.. ...    +--##+-+++++++++++++++\n.++--------++-...--.-#+++++++#++++-...--.. #++++++++--------+#+--++...     .++#++++++#++++++++------\n.++++++-----+-...---. -+++++----+..+.....  ++++++++++++++++++++---+##. ..  .  +++-+++#+----+++++----\n-++++++++++++- ...-+....... .  ...--.....  ++++++++++++++++++---+#+.... .........---+#+++++++++++---\n-############+. ..-.. .. .... .-...-+--.-. ++####+#####+..+--##+.......  ...-##############+++++++++\n-----+#+++++++....  .. ........... ......  .+##+#..---.......++- ....--....++----+--++-++++++#+++-++\n-----+#+++++++-..  .  .... ...-........ ....++++-..     ....... ...---.-++#-..-+++++--------+#+-----\n-++--+#+++++++. ..       ......  ........  . ...--  ..... .. .-... ..-....-.....-++-...-----+++-----\n-++--+#+++++#-  .... .   ..    ...   ..  . ...    .  .....       .....  ...++--------+++--+++#++----\n-++++####+##+. .-+.#-   .    .+.++-...  ......    ........      .-..  .....----.-++++##+++++###+++++\n-++------++++.  -+.-+.  ..  .+-..-+...   .....  . .......    ....      ........ .++---++++++++++++++\n-+++------+++.   .---. .... .-+++-   ........  ....  .......     ..    .....  .--++...-+++++++------\n-+++-++---++++ ..............  ...  ... .....  ....-.........  ....  ...  .  -#-..+++#+++++++++-----\n-++++++----------.  .-+++- .  ........  ...  . ..... ....   ...    ....  ..    -++-..#++++++++++---+\n-+++######+++----.... .-...................  .  ...  .... ..  ...  ..-......-... +####++##########++\n-----+#+--++++-.--.....--... ........-.  .      ....... . ..  ..     ..... ..  .++#...--++--+#++----\n.----++++++-.-+--++#+... ...    .....   .     ..  .      .......          .........---##+++++#+-----\n-+---+#++--+++--+++++##+-......   ....        ... ..... .....   .-.      ..  .... ....++-++++#++----\n-++-+++++++++++++++++##+-.             .       .... ..  .-..            ....  .  .....-#+-+++#+++---\n-##+###################+...  .  ..    .-.  .....   ....--.. .. ...        .  ....     .++#######++++\n------------++#++++++++++... ... .   .-. .......  ... .-. ....     .....     ...--.   --++++++------\n-+-----------+#+++++++++#+...........--.... ..      ..-.  ..     ..     ... ..+#+.  ...+..-+--------\n-+++++-------+#++++++++++#+........ .++. ..        ....   .      .. .--...-++++++-.   .+#-.-++----+-\n-+++++++++-+++#+++++++++++++. ..    .+---...  ......  ..-.....  .    .++++++++++++ ... -+#++++++---+\n-++++########################-.  ..----....  .  .....-+####+-.   ... .---+########.    ..--+######++\n-----+#+++++++-------+++++++++##---...   ...   .. -#++++++++++###-  .  .#++++#+++++     .-++#+------\n-----++++++++++------+#+++++#++. ..... ...    ....###+++--------++..   .----++++++#.  ... ..+#++----\n-+---+#++++++++++----+#++#+.. . ..........  ......-+++++++------++-.    -++++++---++-   ..-+#++++---\n-++++++++++++++++++++++-...         . .. ......-+##++++++++++--++++.   ...++++++++-+++##+++++#++++++\n-++++++++++++##+++##+............ ......---....+###++++++######+###-   ....++#################++++++\n-++---------++#+++-....     .   ....+++--. . -+#+++++-------+#+++++#+.. ..+#+-------+#+------------+\n.+++---------+#+.  .. ... .. ..+###+..     .-+++++++++------+#+++++++######++-------+#++++---------+\n.++++++---++-........  .  .-+++++++.....   .-#++++++++++----++++++++++++++++++------+#++++++-------+\n-++++++++++......- .    .+++++++++. ..  .--+##++++++++++++++++++++++++++++++++++----+#++++-+++++---+\n-+++######-.-. --.  ...++#######+.....  .---++##+##############################################+++++\n-----+#+++#+-..-.. .-#++-+++++++ .. .  -++----------+#         BUGCAT CODEX: COMPLETE        #+----+\n-+---+#++++++++##+++++#+++++-+-....  .+#+++---------+# [reentrancy] [predictable] [overflow] #++----\n-++--++++++++++++----+#++++++-..   ..-+++++++++-----+#      [unprotected] [misspelled]       #+++---\n-+++++#+++++++++++++++#++++-.    ...-#+++++++++++++++#          All wounds witnessed.        #++++++\n-++++++++++++##+++++++#-.... .   ..+##########################################++#############+++++++\n--+----------+#+++-++#............+#++------+#+++-----------+#+++++---------+++---------------------\n.-++---------+#++++++#.......  .+#+++-------+#+++++++-------+#+++++++-------+++-----++++------------\n.-++--------++#++++--++++--+++++++---++++++++#+++++++++----++#++++++++++----+++----+++++++----------";

  // Verify BugcatCodexRenderer
  console.log("\nüîç Verifying BugcatCodexRenderer...");
  try {
    await hre.run("verify:verify", {
      address: contracts.BugcatCodexRenderer,
      constructorArguments: [deploymentInfo.constructorArgs.BugcatCodexRenderer.bugcatRegistry, specialCodeLight, specialCodeDark],
      libraries: {
        "ENSResolver": "0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e" // Mainnet ENS Resolver
      }
    });
    console.log("‚úÖ BugcatCodexRenderer verified successfully");
  } catch (error) {
    console.error("‚ùå BugcatCodexRenderer verification failed:", error.message);
  }

  // Verify BugcatCodex
  console.log("\nüîç Verifying BugcatCodex...");
  try {
    await hre.run("verify:verify", {
      address: contracts.BugcatCodex,
      constructorArguments: [
        deploymentInfo.constructorArgs.BugcatCodex.owner,
        deploymentInfo.constructorArgs.BugcatCodex.bugcatRegistry,
        deploymentInfo.constructorArgs.BugcatCodex.bugcatCount,
        deploymentInfo.constructorArgs.BugcatCodex.renderer,
        deploymentInfo.constructorArgs.BugcatCodex.royaltyReceiver
      ]
    });
    console.log("‚úÖ BugcatCodex verified successfully");
  } catch (error) {
    console.error("‚ùå BugcatCodex verification failed:", error.message);
  }

  console.log("\nüéâ Verification completed!");
  console.log("üìã Verified contracts:");
  console.log("  - BugcatCodexRenderer:", contracts.BugcatCodexRenderer);
  console.log("  - BugcatCodex:", contracts.BugcatCodex);
}

main()
  .then(() => process.exit(0))
  .catch((error) => {
    console.error("‚ùå Verification failed:", error);
    process.exit(1);
  });
